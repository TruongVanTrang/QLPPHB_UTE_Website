<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Quản Lý Điểm Rèn Luyện - Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<style>
body {
    background: linear-gradient(135deg, #0dcaf0, #0099cc);
    font-family: 'Segoe UI', Tahoma;
    min-height: 100vh;
}
.sidebar {
    width: 250px;
    background: #004d61;
    color: white;
    position: fixed;
    top: 0; left: 0; bottom: 0;
}
.sidebar .brand-logo {
    padding: 20px;
    background: #003a4d;
    text-align: center;
    font-weight: bold;
}
.sidebar a {
    color: #a8eeff;
    display: block;
    padding: 15px 20px;
    text-decoration: none;
}
.sidebar a:hover, .sidebar a.active {
    background: #007a99;
    color: white;
}
.main-wrapper {
    margin-left: 250px;
    padding: 30px;
}
.card {
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    padding: 25px;
    margin-bottom: 30px;
}
.xepLoai {
    font-weight: bold;
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
}
.tot { background: #d1e7dd; color: #0f5132; }
.kha { background: #fff3cd; color: #664d03; }
.trungbinh { background: #ffecb5; color: #856404; }
.yeu { background: #f8d7da; color: #842029; }
.btn-action {
    border: none;
    border-radius: 5px;
    padding: 5px 10px;
    color: white;
}
.btn-edit { background: #ffc107; color: black; }
.btn-delete { background: #dc3545; }
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
    <div class="brand-logo">
        <i class="fas fa-chalkboard-teacher me-2"></i>GIÁO VỤ KHOA
    </div>
    <a class="active"><i class="fas fa-running me-2"></i>QL Điểm Rèn Luyện</a>
    <a href="QL_LSHB.html"><i class="fas fa-search me-2"></i>Tra cứu học bổng</a>
</div>

<!-- MAIN -->
<div class="main-wrapper">

<!-- HEADER -->
<div class="card d-flex justify-content-between align-items-center flex-row">
    <h4 class="text-info m-0">
        <i class="fas fa-running me-2"></i>Quản Lý Điểm Rèn Luyện
    </h4>
    <b>Xin chào, Giáo vụ khoa</b>
</div>

<!-- FORM -->
<div class="card" id="formCard" style="display:none;">
<h5 class="text-info mb-3">
    <i class="fas fa-edit me-2"></i>Nhập / Cập nhật điểm rèn luyện
</h5>

<form id="drlForm">
<div class="row">

<div class="col-md-6 mb-3">
<label class="form-label fw-semibold">Mã sinh viên *</label>
<input type="text" id="maSV" class="form-control" required>
</div>

<div class="col-md-6 mb-3">
<label class="form-label fw-semibold">Học kỳ *</label>
<select id="maHK" class="form-select" required>
<option value="">-- Chọn học kỳ --</option>
<option value="HK1_2024">HK1 - 2024-2025</option>
<option value="HK2_2024">HK2 - 2024-2025</option>
<option value="HK1_2025">HK1 - 2025-2026</option>
</select>
</div>

<div class="col-md-6 mb-3">
<label class="form-label fw-semibold">Điểm rèn luyện *</label>
<input type="number" id="diemRL" class="form-control" min="0" max="100" required>
</div>

<div class="col-md-6 mb-3">
<label class="form-label fw-semibold">Xếp loại</label>
<input type="text" id="xepLoaiPreview" class="form-control" disabled>
</div>

<div class="col-md-6 mb-3">
<label class="form-label fw-semibold">Ngày nhập</label>
<input type="date" id="ngayNhap" class="form-control">
</div>

</div>

<div class="mt-3">
<button type="submit" class="btn btn-info text-white">
<i class="fas fa-save me-1"></i>Lưu
</button>
<button type="button" class="btn btn-secondary" onclick="hideForm()">Hủy</button>
</div>
</form>
</div>

<!-- TABLE -->
<div class="card">
<div class="d-flex justify-content-between mb-3">
<h5 class="text-info"><i class="fas fa-list me-2"></i>Danh sách</h5>
<button class="btn btn-info text-white" onclick="showAddForm()">
<i class="fas fa-plus me-1"></i>Thêm mới
</button>
</div>

<table class="table table-hover">
<thead class="table-info">
<tr>
<th>Mã SV</th>
<th>Học kỳ</th>
<th>Điểm</th>
<th>Xếp loại</th>
<th>Ngày nhập</th>
<th>Hành động</th>
</tr>
</thead>
<tbody id="drlTable"></tbody>
</table>
</div>

</div>

<script>
let drlList = [
    { maSV:'21110123', maHK:'HK1_2024', diemRL:95, ngayNhap:'2024-01-20' },
    { maSV:'21110456', maHK:'HK1_2024', diemRL:82, ngayNhap:'2024-01-22' },
    { maSV:'22110789', maHK:'HK2_2024', diemRL:70, ngayNhap:'2024-06-15' },
    { maSV:'22110111', maHK:'HK2_2024', diemRL:60, ngayNhap:'2024-06-18' },
    { maSV:'23110222', maHK:'HK1_2024', diemRL:45, ngayNhap:'2024-01-25' }
];

let editingIndex = null;

function xepLoai(d) {
    if (d >= 90) return ['Xuất sắc','tot'];
    if (d >= 80) return ['Tốt','tot'];
    if (d >= 65) return ['Khá','kha'];
    if (d >= 50) return ['Trung bình','trungbinh'];
    return ['Yếu','yeu'];
}

function render() {
    drlTable.innerHTML = '';
    drlList.forEach((x,i)=>{
        const [txt,cls] = xepLoai(x.diemRL);
        drlTable.innerHTML += `
        <tr>
            <td>${x.maSV}</td>
            <td>${x.maHK}</td>
            <td>${x.diemRL}</td>
            <td><span class="xepLoai ${cls}">${txt}</span></td>
            <td>${x.ngayNhap}</td>
            <td>
                <button class="btn-action btn-edit" onclick="edit(${i})"><i class="fas fa-edit"></i></button>
                <button class="btn-action btn-delete" onclick="del(${i})"><i class="fas fa-trash"></i></button>
            </td>
        </tr>`;
    });
}

function showAddForm() {
    drlForm.reset();
    xepLoaiPreview.value='';
    maSV.readOnly=false;
    maHK.disabled=false;
    editingIndex=null;
    formCard.style.display='block';
    window.scrollTo({top:0,behavior:'smooth'});
}

function hideForm(){
    formCard.style.display='none';
}

function edit(i){
    const x=drlList[i];
    maSV.value=x.maSV;
    maHK.value=x.maHK;
    diemRL.value=x.diemRL;
    ngayNhap.value=x.ngayNhap;
    xepLoaiPreview.value=xepLoai(x.diemRL)[0];
    maSV.readOnly=true;
    maHK.disabled=true;
    editingIndex=i;
    formCard.style.display='block';
}

function del(i){
    if(confirm('Xóa điểm này?')){
        drlList.splice(i,1);
        render();
    }
}

diemRL.oninput=()=> {
    if(diemRL.value>=0 && diemRL.value<=100)
        xepLoaiPreview.value=xepLoai(+diemRL.value)[0];
};

drlForm.onsubmit=e=>{
    e.preventDefault();
    const data={
        maSV:maSV.value.trim(),
        maHK:maHK.value,
        diemRL:+diemRL.value,
        ngayNhap:ngayNhap.value||new Date().toISOString().slice(0,10)
    };
    if(editingIndex===null) drlList.push(data);
    else drlList[editingIndex]=data;
    hideForm();
    render();
};

render();
</script>

</body>
</html>
