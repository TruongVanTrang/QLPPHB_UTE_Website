<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quản Lý Hồ Sơ Sinh Viên - PDT</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
body{
    background:linear-gradient(135deg,#0d6efd,#0043a8);
    font-family:'Segoe UI',Tahoma;
}
.sidebar{
    width:250px;position:fixed;top:0;left:0;bottom:0;
    background:#002a5c;color:white;
}
.brand-logo{
    padding:20px;font-size:1.4rem;font-weight:bold;
    text-align:center;background:#001f45;
}
.nav-link{color:#a8cfff;padding:15px 20px;display:block;text-decoration:none}
.nav-link.active,.nav-link:hover{background:#0043a8;color:#fff}
.main-wrapper{margin-left:250px;padding:30px}
.card{
    background:white;border-radius:15px;padding:30px;
    box-shadow:0 5px 20px rgba(0,0,0,.1);margin-bottom:30px;
}
.data-table th{background:#f0f7ff;color:#0043a8}
.btn-action{border:none;padding:5px 10px;border-radius:5px;color:white}
.btn-edit{background:#ffc107;color:black}
.btn-delete{background:#dc3545}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
    <div class="brand-logo">
        <i class="fas fa-graduation-cap me-2"></i>P. ĐÀO TẠO
    </div>
    <a class="nav-link active" href="#"><i class="fas fa-id-card me-2"></i>QL Hồ sơ SV</a>
    <a class="nav-link" href="QL_GPA.html"><i class="fas fa-file-excel me-2"></i>QL GPA</a>
</div>

<div class="main-wrapper">

<!-- HEADER -->
<div class="card d-flex justify-content-between align-items-center flex-row">
    <h4 class="text-primary m-0">
        <i class="fas fa-id-card me-2"></i>Quản Lý Hồ Sơ Sinh Viên
    </h4>
    <b>Cán bộ Phòng Đào Tạo</b>
</div>

<!-- FORM (ẨN BAN ĐẦU) -->
<div class="card" id="formCard" style="display:none">
<h5 class="text-primary mb-3"><i class="fas fa-edit me-2"></i>Thêm / Cập Nhật Sinh Viên</h5>

<form id="studentForm">
<div class="row">
    <div class="col-md-6 mb-3">
        <label>Mã SV</label>
        <input type="text" id="maSV" class="form-control" required>
    </div>
    <div class="col-md-6 mb-3">
        <label>Họ Tên</label>
        <input type="text" id="hoTen" class="form-control" required>
    </div>

    <div class="col-md-6 mb-3">
        <label>Ngày Sinh</label>
        <input type="date" id="ngaySinh" class="form-control" required>
    </div>
    <div class="col-md-6 mb-3">
        <label>Giới Tính</label>
        <select id="gioiTinh" class="form-select">
            <option>Nam</option>
            <option>Nữ</option>
        </select>
    </div>

    <div class="col-md-6 mb-3">
        <label>Email</label>
        <input type="email" id="email" class="form-control">
    </div>
    <div class="col-md-6 mb-3">
        <label>SĐT</label>
        <input type="text" id="sdt" class="form-control">
    </div>

    <div class="col-md-6 mb-3">
        <label>Khoa</label>
        <select id="maKhoa" class="form-select" onchange="loadLop()"></select>
    </div>
    <div class="col-md-6 mb-3">
        <label>Lớp</label>
        <select id="maLop" class="form-select"></select>
    </div>
</div>

<button class="btn btn-primary" type="submit">Lưu</button>
<button class="btn btn-secondary" type="button" onclick="hideForm()">Hủy</button>
</form>
</div>

<!-- TABLE -->
<div class="card">
<div class="d-flex justify-content-between mb-3">
    <h5 class="text-primary"><i class="fas fa-list me-2"></i>Danh sách sinh viên</h5>
    <button class="btn btn-primary" onclick="showForm()">
        <i class="fas fa-plus me-1"></i>Thêm mới
    </button>
</div>

<table class="table table-hover data-table">
<thead>
<tr>
<th>Mã SV</th><th>Họ Tên</th><th>Ngày Sinh</th>
<th>Giới Tính</th><th>Email</th><th>SĐT</th>
<th>Khoa</th><th>Lớp</th><th>Hành động</th>
</tr>
</thead>
<tbody id="svTable"></tbody>
</table>
</div>

</div>

<script>
/* ====== DATA MẪU CHUẨN DB ====== */
const khoas = [
 {MaKhoa:'CNTT',TenKhoa:'Công nghệ thông tin'},
 {MaKhoa:'CK',TenKhoa:'Cơ khí'},
 {MaKhoa:'DT',TenKhoa:'Điện - Điện tử'},
{MaKhoa:'SPKT',TenKhoa:'Sư phạm kỹ thuật'}
];

const lops = [
 {MaLop:'21110CNT',TenLop:'CNTT 2021',MaKhoa:'CNTT'},
 {MaLop:'22110CNT',TenLop:'CNTT 2022',MaKhoa:'CNTT'},
 {MaLop:'22110CK',TenLop:'Cơ khí 2022',MaKhoa:'CK'},
 {MaLop:'22110DT',TenLop:'Điện tử 2022',MaKhoa:'DT'},
    {MaLop:'23SK01',TenLop:'SPKT 2023',MaKhoa:'SPKT'}
];

let students = JSON.parse(localStorage.getItem('SV')) || [
 {MaSV:'21110123',HoTen:'Nguyễn Văn An',NgaySinh:'2003-01-15',GioiTinh:'Nam',Email:'an@ute.edu.vn',SDT:'0901112222',MaLop:'21110CNT'},
 {MaSV:'22110456',HoTen:'Trần Thị Bích',NgaySinh:'2004-06-20',GioiTinh:'Nữ',Email:'bich@ute.edu.vn',SDT:'0903334444',MaLop:'22110CK'}
];

let editIndex=null;

/* ====== FORM ====== */
function showForm(){
 document.getElementById('studentForm').reset();
 document.getElementById('maSV').disabled=false;
 editIndex=null;
 document.getElementById('formCard').style.display='block';
}
function hideForm(){
 document.getElementById('formCard').style.display='none';
}

/* ====== LOAD SELECT ====== */
function loadKhoa(){
 const s=document.getElementById('maKhoa');
 s.innerHTML='';
 khoas.forEach(k=>s.innerHTML+=`<option value="${k.MaKhoa}">${k.TenKhoa}</option>`);
 loadLop();
}
function loadLop(){
 const maKhoa=document.getElementById('maKhoa').value;
 const s=document.getElementById('maLop');
 s.innerHTML='';
 lops.filter(l=>l.MaKhoa===maKhoa)
     .forEach(l=>s.innerHTML+=`<option value="${l.MaLop}">${l.MaLop}</option>`);
}

/* ====== TABLE ====== */
function render(){
 const tb=document.getElementById('svTable');
 tb.innerHTML='';
 students.forEach((s,i)=>{
  const lop=lops.find(l=>l.MaLop===s.MaLop);
  const khoa=khoas.find(k=>k.MaKhoa===lop.MaKhoa);
  tb.innerHTML+=`
  <tr>
   <td>${s.MaSV}</td>
   <td>${s.HoTen}</td>
   <td>${s.NgaySinh}</td>
   <td>${s.GioiTinh}</td>
   <td>${s.Email}</td>
   <td>${s.SDT}</td>
   <td>${khoa.TenKhoa}</td>
   <td>${s.MaLop}</td>
   <td>
    <button class="btn-action btn-edit" onclick="edit(${i})"><i class="fas fa-edit"></i></button>
    <button class="btn-action btn-delete" onclick="del(${i})"><i class="fas fa-trash"></i></button>
   </td>
  </tr>`;
 });
 localStorage.setItem('SV',JSON.stringify(students));
}

function edit(i){
 const s=students[i];
 maSV.value=s.MaSV;maSV.disabled=true;
 hoTen.value=s.HoTen;ngaySinh.value=s.NgaySinh;
 gioiTinh.value=s.GioiTinh;
 email.value=s.Email;sdt.value=s.SDT;
 const lop=lops.find(l=>l.MaLop===s.MaLop);
 maKhoa.value=lop.MaKhoa;
 loadLop();maLop.value=s.MaLop;
 editIndex=i;
 showForm();
}

function del(i){
 if(confirm('Xóa sinh viên?')){students.splice(i,1);render();}
}

studentForm.onsubmit=e=>{
 e.preventDefault();
 const sv={
  MaSV:maSV.value,HoTen:hoTen.value,NgaySinh:ngaySinh.value,
  GioiTinh:gioiTinh.value,Email:email.value,SDT:sdt.value,
  MaLop:maLop.value
 };
 if(editIndex===null) students.push(sv);
 else students[editIndex]=sv;
 hideForm();render();
};

loadKhoa();render();
</script>
</body>
</html>
