<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Quản Lý Điểm GPA - Phòng Đào Tạo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<style>
body {
    background: linear-gradient(135deg, #0d6efd, #0043a8);
    font-family: 'Segoe UI', Tahoma;
    min-height: 100vh;
}
.sidebar {
    width: 250px;
    background: #002a5c;
    color: white;
    position: fixed;
    top: 0; left: 0; bottom: 0;
}
.sidebar .brand-logo {
    padding: 20px;
    background: #001f45;
    text-align: center;
    font-weight: bold;
}
.sidebar a {
    color: #a8cfff;
    display: block;
    padding: 15px 20px;
    text-decoration: none;
}
.sidebar a:hover, .sidebar a.active {
    background: #0043a8;
    color: white;
}
.main-wrapper {
    margin-left: 250px;
    padding: 30px;
}
.card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    padding: 25px;
    margin-bottom: 30px;
}
.xepLoai {
    font-weight: bold;
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
}
.xuatSac { background:#d1e7dd;color:#0f5132; }
.gioi { background:#cfe2ff;color:#084298; }
.kha { background:#fff3cd;color:#664d03; }
.trungBinh { background:#ffecb5;color:#856404; }
.yeu { background:#f8d7da;color:#842029; }
.btn-action {
    border:none;
    border-radius:5px;
    padding:5px 10px;
    color:white;
}
.btn-edit { background:#ffc107;color:black; }
.btn-delete { background:#dc3545; }
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
    <div class="brand-logo">
        <i class="fas fa-graduation-cap me-2"></i>P. ĐÀO TẠO
    </div>
    <a class="active"><i class="fas fa-file-excel me-2"></i>QL Điểm GPA</a>
    <a href="QL_HSSV.html"><i class="fas fa-id-card me-2"></i>QL Hồ sơ SV</a>
</div>

<!-- MAIN -->
<div class="main-wrapper">

<!-- HEADER -->
<div class="card d-flex justify-content-between align-items-center flex-row">
    <h4 class="text-primary m-0">
        <i class="fas fa-file-excel me-2"></i>Quản Lý Điểm GPA
    </h4>
    <b>Xin chào, Cán bộ Đào Tạo</b>
</div>

<!-- FORM (ẨN BAN ĐẦU) -->
<div class="card" id="formCard" style="display:none;">
<h5 class="text-primary mb-3">
    <i class="fas fa-edit me-2"></i>Nhập / Cập nhật điểm GPA
</h5>

<form id="gpaForm">
<div class="row">

<div class="col-md-6 mb-3">
<label class="fw-semibold">Mã sinh viên *</label>
<input type="text" id="maSV" class="form-control" required>
</div>

<div class="col-md-6 mb-3">
<label class="fw-semibold">Học kỳ *</label>
<select id="maHK" class="form-select" required>
<option value="">-- Chọn học kỳ --</option>
<option value="HK1_2024">HK1 - 2024-2025</option>
<option value="HK2_2024">HK2 - 2024-2025</option>
<option value="HK1_2025">HK1 - 2025-2026</option>
</select>
</div>

<div class="col-md-6 mb-3">
<label class="fw-semibold">Điểm GPA *</label>
<input type="number" id="gpa" step="0.01" min="0" max="4" class="form-control" required>
</div>

<div class="col-md-6 mb-3">
<label class="fw-semibold">Xếp loại</label>
<input type="text" id="xepLoaiPreview" class="form-control" disabled>
</div>

<div class="col-md-6 mb-3">
<label class="fw-semibold">Ngày cập nhật</label>
<input type="date" id="ngayCapNhat" class="form-control">
</div>

</div>

<div class="mt-3">
<button type="submit" class="btn btn-primary">
<i class="fas fa-save me-1"></i>Lưu
</button>
<button type="button" class="btn btn-secondary" onclick="hideForm()">Hủy</button>
</div>
</form>
</div>

<!-- TABLE -->
<div class="card">
<div class="d-flex justify-content-between mb-3">
<h5 class="text-primary"><i class="fas fa-list me-2"></i>Danh sách GPA</h5>
<button class="btn btn-primary" onclick="showAddForm()">
<i class="fas fa-plus me-1"></i>Thêm mới
</button>
</div>

<table class="table table-hover">
<thead class="table-primary">
<tr>
<th>Mã SV</th>
<th>Học kỳ</th>
<th>GPA</th>
<th>Xếp loại</th>
<th>Ngày cập nhật</th>
<th>Hành động</th>
</tr>
</thead>
<tbody id="gpaTable"></tbody>
</table>
</div>

</div>

<script>
let gpaList = [
    { maSV:'21110123', maHK:'HK1_2024', gpa:3.75, ngayCapNhat:'2024-01-15' },
    { maSV:'21110456', maHK:'HK1_2024', gpa:3.30, ngayCapNhat:'2024-01-15' },
    { maSV:'22110789', maHK:'HK2_2024', gpa:2.80, ngayCapNhat:'2024-06-20' },
    { maSV:'22110111', maHK:'HK2_2024', gpa:2.10, ngayCapNhat:'2024-06-20' },
    { maSV:'23110222', maHK:'HK1_2024', gpa:1.50, ngayCapNhat:'2024-08-30' }
];

let editingIndex = null;

function tinhXepLoai(gpa){
    if(gpa>=3.6) return ['Xuất sắc','xuatSac'];
    if(gpa>=3.2) return ['Giỏi','gioi'];
    if(gpa>=2.5) return ['Khá','kha'];
    if(gpa>=2.0) return ['Trung bình','trungBinh'];
    return ['Yếu','yeu'];
}

function render(){
    gpaTable.innerHTML='';
    gpaList.forEach((x,i)=>{
        const [txt,cls]=tinhXepLoai(x.gpa);
        gpaTable.innerHTML+=`
        <tr>
            <td>${x.maSV}</td>
            <td>${x.maHK}</td>
            <td>${x.gpa.toFixed(2)}</td>
            <td><span class="xepLoai ${cls}">${txt}</span></td>
            <td>${x.ngayCapNhat}</td>
            <td>
                <button class="btn-action btn-edit" onclick="edit(${i})"><i class="fas fa-edit"></i></button>
                <button class="btn-action btn-delete" onclick="del(${i})"><i class="fas fa-trash"></i></button>
            </td>
        </tr>`;
    });
}

function showAddForm(){
    gpaForm.reset();
    xepLoaiPreview.value='';
    maSV.readOnly=false;
    maHK.disabled=false;
    editingIndex=null;
    formCard.style.display='block';
    window.scrollTo({top:0,behavior:'smooth'});
}

function hideForm(){
    formCard.style.display='none';
}

function edit(i){
    const x=gpaList[i];
    maSV.value=x.maSV;
    maHK.value=x.maHK;
    gpa.value=x.gpa;
    ngayCapNhat.value=x.ngayCapNhat;
    xepLoaiPreview.value=tinhXepLoai(x.gpa)[0];
    maSV.readOnly=true;
    maHK.disabled=true;
    editingIndex=i;
    formCard.style.display='block';
}

function del(i){
    if(confirm('Xóa điểm GPA này?')){
        gpaList.splice(i,1);
        render();
    }
}

gpa.oninput=()=>{
    if(gpa.value>=0 && gpa.value<=4)
        xepLoaiPreview.value=tinhXepLoai(+gpa.value)[0];
};

gpaForm.onsubmit=e=>{
    e.preventDefault();
    const data={
        maSV:maSV.value.trim(),
        maHK:maHK.value,
        gpa:+gpa.value,
        ngayCapNhat:ngayCapNhat.value||new Date().toISOString().slice(0,10)
    };
    if(editingIndex===null) gpaList.push(data);
    else gpaList[editingIndex]=data;
    hideForm();
    render();
};

render();
</script>

</body>
</html>
