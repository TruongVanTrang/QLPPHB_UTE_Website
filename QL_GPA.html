<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Điểm GPA</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #e0e0e0;
            margin: 0;
            padding: 30px;
            min-height: 100vh;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        header {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px;
        }
        header h1 {
            margin: 0;
            font-size: 2.2em;
            font-weight: bold;
        }
        .content {
            padding: 30px;
        }
        h2 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 8px;
            margin-top: 0;
        }
        form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        .full {
            grid-column: span 2;
        }
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #2c3e50;
        }
        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 11px 14px;
            border: 1px solid #bdc3c7;
            border-radius: 6px;
            font-size: 15px;
            box-sizing: border-box;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 14px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover {
            background: #2980b9;
        }
        #updateBtn { background: #27ae60; }
        #updateBtn:hover { background: #219a52; }
        #cancelBtn { background: #e74c3c; margin-left: 10px; }
        #cancelBtn:hover { background: #c0392b; }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            background: #f8f9fa;
        }
        th {
            background: #ecf0f1;
            padding: 14px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            border-bottom: 2px solid #ddd;
        }
        td {
            padding: 12px 14px;
            border-bottom: 1px solid #eee;
        }
        tr:hover {
            background: #f1f8ff;
        }
        .actions button {
            padding: 6px 12px;
            font-size: 13px;
            margin-right: 6px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .edit-btn {
            background: #f39c12;
            color: white;
        }
        .edit-btn:hover { background: #e67e22; }
        .delete-btn {
            background: #e74c3c;
            color: white;
        }
        .delete-btn:hover { background: #c0392b; }
        .xepLoai {
            font-weight: bold;
        }
        .xuatSac { color: #27ae60; }
        .gioi { color: #3498db; }
        .kha { color: #f39c12; }
        .trungBinh { color: #e67e22; }
        .yeu { color: #e74c3c; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>NHÓM PHÒNG ĐÀO TẠO (PDT)</h1>
        </header>
        
        <div class="content">
            <h2>5. Trang Quản Lý Điểm GPA</h2>
            
            <h3 style="margin-top: 30px; color:#34495e;">Form Thêm/Cập Nhật Điểm GPA</h3>
            
            <form id="gpaForm">
                <div>
                    <label>Mã SV:</label>
                    <input type="text" id="maSV" required placeholder="VD: 123">
                </div>
                <div>
                    <label>Học Kỳ:</label>
                    <select id="maHK" required>
                        <option value="">Chọn Học Kỳ</option>
                        <option value="HK1">HK1 - Năm 2024-2025</option>
                        <option value="HK2">HK2 - Năm 2024-2025</option>
                        <option value="HK3">HK3 - Năm 2024-2025</option>
                        <option value="HK1_2025">HK1 - Năm 2025-2026</option>
                        <option value="HK2_2025">HK2 - Năm 2025-2026</option>
                    </select>
                </div>
                <div>
                    <label>Điểm GPA:</label>
                    <input type="number" id="gpa" step="0.01" min="0" max="4" required placeholder="VD: 3.45">
                </div>
                <div>
                    <label>Ngày Cập Nhật:</label>
                    <input type="date" id="ngayCapNhat" required>
                </div>
                
                <div class="full" style="margin-top: 10px;">
                    <button type="submit" id="submitBtn">Thêm Điểm GPA</button>
                    <button type="button" id="updateBtn" style="display:none;">Cập Nhật Điểm</button>
                    <button type="button" id="cancelBtn" style="display:none;">Hủy</button>
                </div>
            </form>

            <h3 style="margin-top: 50px; color:#34495e;">Danh Sách Điểm GPA</h3>
            <table id="gpaTable">
                <thead>
                    <tr>
                        <th>Mã SV</th>
                        <th>Học Kỳ</th>
                        <th>Điểm GPA</th>
                        <th>Xếp Loại</th>
                        <th>Ngày Cập Nhật</th>
                        <th>Hành Động</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script>
        // Dữ liệu học kỳ mẫu (có thể mở rộng)
        const hocKyList = [
            { maHK: "HK1", tenHK: "HK1 - Năm 2024-2025" },
            { maHK: "HK2", tenHK: "HK2 - Năm 2024-2025" },
            { maHK: "HK3", tenHK: "HK3 - Năm 2024-2025" },
            { maHK: "HK1_2025", tenHK: "HK1 - Năm 2025-2026" },
            { maHK: "HK2_2025", tenHK: "HK2 - Năm 2025-2026" }
        ];

        // Lấy danh sách GPA từ LocalStorage
        let gpaList = JSON.parse(localStorage.getItem('gpaList')) || [];
        let editingIndex = null;

        const tbody = document.querySelector('#gpaTable tbody');
        const form = document.getElementById('gpaForm');
        const submitBtn = document.getElementById('submitBtn');
        const updateBtn = document.getElementById('updateBtn');
        const cancelBtn = document.getElementById('cancelBtn');

        // Tự động điền danh sách học kỳ
        function loadHocKy() {
            const select = document.getElementById('maHK');
            select.innerHTML = '<option value="">Chọn Học Kỳ</option>';
            hocKyList.forEach(hk => {
                const opt = document.createElement('option');
                opt.value = hk.maHK;
                opt.textContent = hk.tenHK;
                select.appendChild(opt);
            });
        }

        // Tính xếp loại theo GPA
        function tinhXepLoai(gpa) {
            gpa = parseFloat(gpa);
            if (gpa >= 3.6) return { text: "Xuất sắc", class: "xuatSac" };
            if (gpa >= 3.2) return { text: "Giỏi", class: "gioi" };
            if (gpa >= 2.5) return { text: "Khá", class: "kha" };
            if (gpa >= 2.0) return { text: "Trung bình", class: "trungBinh" };
            return { text: "Yếu", class: "yeu" };
        }

        function renderTable() {
            tbody.innerHTML = '';
            gpaList.forEach((item, i) => {
                const xl = tinhXepLoai(item.gpa);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${item.maSV}</td>
                    <td>${item.maHK}</td>
                    <td>${parseFloat(item.gpa).toFixed(2)}</td>
                    <td class="xepLoai ${xl.class}">${xl.text}</td>
                    <td>${item.ngayCapNhat}</td>
                    <td class="actions">
                        <button class="edit-btn" onclick="editGPA(${i})">Sửa</button>
                        <button class="delete-btn" onclick="deleteGPA(${i})">Xóa</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function saveToStorage() {
            localStorage.setItem('gpaList', JSON.stringify(gpaList));
        }

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const data = {
                maSV: document.getElementById('maSV').value.trim(),
                maHK: document.getElementById('maHK').value,
                gpa: parseFloat(document.getElementById('gpa').value).toFixed(2),
                ngayCapNhat: document.getElementById('ngayCapNhat').value
            };

            if (editingIndex !== null) {
                gpaList[editingIndex] = data;
                editingIndex = null;
                submitBtn.style.display = 'block';
                updateBtn.style.display = 'none';
                cancelBtn.style.display = 'none';
                alert('Cập nhật điểm GPA thành công!');
            } else {
                gpaList.push(data);
                alert('Thêm điểm GPA thành công!');
            }

            saveToStorage();
            renderTable();
            form.reset();
        });

        window.editGPA = function(i) {
            const item = gpaList[i];
            document.getElementById('maSV').value = item.maSV;
            document.getElementById('maHK').value = item.maHK;
            document.getElementById('gpa').value = item.gpa;
            document.getElementById('ngayCapNhat').value = item.ngayCapNhat;

            editingIndex = i;
            submitBtn.style.display = 'none';
            updateBtn.style.display = 'inline-block';
            cancelBtn.style.display = 'inline-block';
        };

        cancelBtn.onclick = () => {
            editingIndex = null;
            form.reset();
            submitBtn.style.display = 'block';
            updateBtn.style.display = 'none';
            cancelBtn.style.display = 'none';
        };

        window.deleteGPA = function(i) {
            if (confirm('Xóa điểm GPA này?')) {
                gpaList.splice(i, 1);
                saveToStorage();
                renderTable();
            }
        };

        // Khởi tạo
        loadHocKy();
        renderTable();
    </script>
</body>
</html>